<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog-transition.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">

<polymer-element name="flow-node" attributes="node">
    <template>
        <style>
            .node {
                width: 200px;
                height: 50px;
                background-color: #4285f4;;
                border-radius: 5px;
                text-align: center;
                line-height: 50px;
                color: white;
                z-index: 1;
            }

            .node:hover {
                opacity: .75;
            }

            paper-dialog {
                width: 50%;
                min-width: 430px;
            }

            .line {
                position: absolute;
                background-color: #333333;
                width: 0px;
                height: 3px;
            }

            .line.bottom-line {
                -webkit-transform: rotate(90deg);
                -webkit-transform-origin:0% 0%;
            }
            .line.right-line {
            }
        </style>

        <div class="node" style="background-color: {{node.bgColor}}; position: absolute; top: {{node.top}}px; left: {{node.left}}px; width: {{node.width}}px; height: {{node.height}}px;" on-click="{{select}}">
            <span>{{node.text}}</span>
            <paper-shadow z="{{$.settings.opened ? 2 : 0}}"></paper-shadow>

            <div class="line bottom-line" style="top: {{node.height}}px; left: {{node.width/2}}px; width: {{node.lineLengthBottom}}px"></div>

            <div class="line right-line" style="top: {{node.height/2}}px; left: {{node.width}}px; width: {{node.lineLengthRight}}px"></div>
        </div>



        <paper-dialog id="settings" transition="paper-dialog-transition-bottom" style="background-color: transparent">
            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: white; z-index: -1; opacity: .75;"></div>
            <br/>
            <paper-input floatingLabel label="Text" value="{{node.text}}" style="font-size: 24px; font-weight: bold"></paper-input><br />
            <paper-input floatingLabel label="Color" value="{{node.bgColor}}" style="font-size: 24px; font-weight: bold; color: #777777; background-color: {{node.bgColor}}"></paper-input><br />
            <paper-input floatingLabel label="Width" value="{{node.width}}" validate="^[0-9]*$" error="Input is not a number!" style="font-size: 18px; font-weight: bold"></paper-input><br />
            <paper-input floatingLabel label="Height" value="{{node.height}}" validate="^[0-9]*$" error="Input is not a number!" style="font-size: 18px; font-weight: bold"></paper-input><br />
            <paper-input floatingLabel label="Top" value="{{node.top}}" validate="^[0-9]*$" error="Input is not a number!" style="font-size: 18px; font-weight: bold"></paper-input><br />
            <paper-input floatingLabel label="Left" value="{{node.left}}" validate="^[0-9]*$" error="Input is not a number!" style="font-size: 18px; font-weight: bold"></paper-input><br />
            <paper-input floatingLabel label="Line Bottom" value="{{node.lineLengthBottom}}" validate="^[0-9]*$" error="Input is not a number!" style="font-size: 18px; font-weight: bold"></paper-input><br />
            <paper-input floatingLabel label="Line Right" value="{{node.lineLengthRight}}" validate="^[0-9]*$" error="Input is not a number!" style="font-size: 18px; font-weight: bold"></paper-input><br />

            <paper-button label="Ok" affirmative default></paper-button>

            </div>

        </paper-dialog>

    </template>
    <script>
        Polymer('flow-node', {
            select: function () {
                this.$.settings.opened = true;
            }
        });
    </script>
</polymer-element>